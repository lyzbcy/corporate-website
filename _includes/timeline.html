<!-- Tree of Works Timeline (3-Track) -->
<section class="page-section" id="timeline">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 text-center">
        <h2 class="section-heading text-uppercase">作品时间树</h2>
        <h3 class="section-subheading text-muted">我们的创意发展历程</h3>
      </div>
    </div>

    <div class="tree-container" id="tree-container">
      <!-- Filter Labels (Top of Trunk) -->
      <div class="tree-filters">
        <div class="filter-btn school" data-filter="school">学校作品</div>
        <div class="filter-btn personal" data-filter="personal">个人作品</div>
        <div class="filter-btn team" data-filter="team">团队作品</div>
      </div>

      <!-- Tree Crown (Extended from Trunk Lines) -->
      <svg class="tree-crown-svg" viewBox="0 0 400 150" preserveAspectRatio="xMidYMax meet">
        <defs>
          <filter id="glow" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="6" result="coloredBlur" />
            <feMerge>
              <feMergeNode in="coloredBlur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>

        <!-- Left trunk line extends up and curves into large circle (Green) -->
        <path d="M185,150 L185,100 Q185,60 150,30" stroke="#00f260" stroke-width="5" fill="none" stroke-linecap="round"
          filter="url(#glow)" />
        <circle cx="130" cy="40" r="55" fill="rgba(0, 242, 96, 0.2)" stroke="#00f260" stroke-width="4"
          filter="url(#glow)" />

        <!-- Center trunk line extends up (Pink) -->
        <path d="M200,150 L200,80 Q200,50 200,30" stroke="#ff00cc" stroke-width="5" fill="none" stroke-linecap="round"
          filter="url(#glow)" />
        <circle cx="200" cy="45" r="50" fill="rgba(255, 0, 204, 0.2)" stroke="#ff00cc" stroke-width="4"
          filter="url(#glow)" />

        <!-- Right trunk line extends up and curves (Gold) -->
        <path d="M215,150 L215,100 Q215,60 250,30" stroke="#D4AF37" stroke-width="5" fill="none" stroke-linecap="round"
          filter="url(#glow)" />
        <circle cx="270" cy="40" r="55" fill="rgba(212, 175, 55, 0.2)" stroke="#D4AF37" stroke-width="4"
          filter="url(#glow)" />
      </svg>

      <!-- Bundled Trunk (3 Lines) -->
      <div class="tree-trunk-bundle">
        <div class="trunk-line school"></div>
        <div class="trunk-line personal"></div>
        <div class="trunk-line team"></div>
      </div>

      {% assign sorted_projects = site.portfolio | sort: 'date' | reverse %}
      {% for project in sorted_projects %}
      {% assign remainder = forloop.index | modulo: 2 %}
      {% if project.category == 'school' %}
      {% assign category = "school" %}
      {% assign catText = "学校作品" %}
      {% elsif project.category == 'personal' %}
      {% assign category = "personal" %}
      {% assign catText = "个人作品" %}
      {% elsif project.category == 'team' %}
      {% assign category = "team" %}
      {% assign catText = "团队作品" %}
      {% else %}
      {% assign category = "personal" %}
      {% assign catText = "个人作品" %}
      {% endif %}

      <div class="tree-item {% if remainder == 0 %}right{% else %}left{% endif %} {{ category }}-item">
        <div class="tree-branch">
          <span class="branch-date">{{ project.date | date: "%Y.%m.%d" }}</span>
        </div>
        <a class="tree-content" data-toggle="modal" data-target="#p-{{ project.caption.title | slugify }}"
          href="#p-{{ project.caption.title | slugify }}" style="text-decoration: none; color: inherit;">
          <div class="tree-img-wrapper">
            {% if project.caption.thumbnail contains 'http' %}
            <img src="{{ project.caption.thumbnail }}" alt="{{ project.caption.title }}">
            {% else %}
            <img src="{{ site.baseurl }}/{{ project.caption.thumbnail }}" alt="{{ project.caption.title }}">
            {% endif %}
          </div>
          <div class="tree-text">
            <h4>{{ project.caption.title }}</h4>
            <span class="project-tag">{{ catText }}</span>
            <p>{{ project.caption.subtitle }}</p>
          </div>
        </a>
      </div>
      {% endfor %}

      <!-- Tree Roots (Extended from Trunk Lines) -->
      <svg class="tree-roots-svg" viewBox="0 0 400 180" preserveAspectRatio="xMidYMin meet">
        <defs>
          <filter id="rootGlow" x="-100%" y="-100%" width="300%" height="300%">
            <feGaussianBlur stdDeviation="6" result="coloredBlur" />
            <feMerge>
              <feMergeNode in="coloredBlur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>

        <!-- Left trunk line extends down and splits into roots (Green) -->
        <!-- Main extension -->
        <path d="M185,0 L185,40 Q185,80 120,140 Q100,160 80,175" stroke="#00f260" stroke-width="6" fill="none"
          stroke-linecap="round" filter="url(#rootGlow)" />
        <!-- Secondary branch -->
        <path d="M185,60 Q170,100 140,160" stroke="#00f260" stroke-width="4" fill="none" stroke-linecap="round"
          filter="url(#rootGlow)" opacity="0.8" />

        <!-- Center trunk line extends down (Pink) -->
        <path d="M200,0 L200,50 Q200,120 200,170" stroke="#ff00cc" stroke-width="6" fill="none" stroke-linecap="round"
          filter="url(#rootGlow)" />
        <!-- Side branches -->
        <path d="M200,80 Q190,120 175,165" stroke="#ff00cc" stroke-width="4" fill="none" stroke-linecap="round"
          filter="url(#rootGlow)" opacity="0.7" />
        <path d="M200,80 Q210,120 225,165" stroke="#ff00cc" stroke-width="4" fill="none" stroke-linecap="round"
          filter="url(#rootGlow)" opacity="0.7" />

        <!-- Right trunk line extends down and splits (Gold) -->
        <!-- Main extension -->
        <path d="M215,0 L215,40 Q215,80 280,140 Q300,160 320,175" stroke="#D4AF37" stroke-width="6" fill="none"
          stroke-linecap="round" filter="url(#rootGlow)" />
        <!-- Secondary branch -->
        <path d="M215,60 Q230,100 260,160" stroke="#D4AF37" stroke-width="4" fill="none" stroke-linecap="round"
          filter="url(#rootGlow)" opacity="0.8" />
      </svg>
    </div>
  </div>
</section>